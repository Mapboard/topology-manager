#!/bin/bash

user=davenquinn
image=ghcr.io/$user/geologic-map
version=$(cat package.json | jq -r '.version') 

docker build -t $image:$version -t $image:latest .

GITHUB_ACCESS_TOKEN=$(security find-generic-password -w -s "GitHub access token")
echo $GITHUB_ACCESS_TOKEN | docker login ghcr.io -u $user --password-stdin

echo "Pushing images"
docker push $image:$version
docker push $image:latest